<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="robots" content="index, follow, all" />
    <title>LibPBSAuth\VPPA | API</title>

            <link rel="stylesheet" type="text/css" href="../css/normalize.css">
        <link rel="stylesheet" type="text/css" href="../css/min.css">
        <link rel="stylesheet" type="text/css" href="../css/prism.css">
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,700,400italic' rel='stylesheet' type='text/css'>
        <script src="../js/prism.js"></script>
        <meta name="MobileOptimized" content="width">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    
    
    </head>

    <body id="class" data-name="class:LibPBSAuth_VPPA" data-root-path="../">
            <nav>
    <div class="container">
      <div class="title">
        <a href="../index.html">API</a>
      </div>
      <ul>
        <li><a href="../classes.html">Classes</a></li>
                  <li><a href="../namespaces.html">Namespaces</a></li>
                <li><a href="../interfaces.html">Interfaces</a></li>
        <li><a href="../traits.html">Traits</a></li>
        <li><a href="../doc-index.html">Index</a></li>
        <li><a href="../search.html">Search</a></li>
      </ul>
                  <ol class="breadcrumb">
                                  <li><a href="../LibPBSAuth.html">LibPBSAuth</a></li>
  
            <li>VPPA</li>
        </ol>
        </div>
  </nav>

  <div class="container">
    <div class="row">
        <div id="control-panel">
      </div>

        <div id="api-tree"></div>

    </div>
    <div class="row">
          <h1>VPPA</h1>

    <p>    class
    <strong>VPPA</strong>        implements
        <a target="_blank" href="http://php.net/JsonSerializable"><abbr title="JsonSerializable">JsonSerializable</abbr></a>
</p>

            <p>Class VPPA</p>        <p>Describes VPPA agreement information for the authenticated user and the
authenticating station. Requires only that the vppa_accepted and
vppa_last_updated fields are present. If vppa_last_updated contains a truthy
value, then it must be able to be parsed into a \DateTime.</p>    
    
            <h2>Constants</h2>

            <table class="table">
                    <tr>
                <td><code class="language-php">EXISTS =  [</code></td>
                <td>
                    <p><em></em></p>
                    <p></p>
                </td>
            </tr>
                    <tr>
                <td><code class="language-php">DATEFORMAT =  &#039;Y-m-d H:i:s.uP&#039;;</code></td>
                <td>
                    <p><em></em></p>
                    <p></p>
                </td>
            </tr>
            </table>

    
    
            <h2>Methods</h2>

            <table class="table">
            <tr>
            <td>
                <code class="language-php">
                                                            public                    static                </code>
            </td>
            <td class="text-right"><code class="language-php"><a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a></code></td>
            <td>
                <code class="language-php"><a href="#method_fromJSON">fromJSON</a>(string $record)</code>
            </td>
            <td>
                                    No description
                            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                    static                </code>
            </td>
            <td class="text-right"><code class="language-php"><a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a></code></td>
            <td>
                <code class="language-php"><a href="#method_fromArray">fromArray</a>(array $record)</code>
            </td>
            <td>
                                    No description
                            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                    static                </code>
            </td>
            <td class="text-right"><code class="language-php"><a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a></code></td>
            <td>
                <code class="language-php"><a href="#method_fromStdClass">fromStdClass</a>(<a target="_blank" href="http://php.net/stdClass"><abbr title="stdClass">stdClass</abbr></a> $record)</code>
            </td>
            <td>
                                    No description
                            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                                    </code>
            </td>
            <td class="text-right"><code class="language-php">array</code></td>
            <td>
                <code class="language-php"><a href="#method_toArray">toArray</a>()</code>
            </td>
            <td>
                                    No description
                            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                                    </code>
            </td>
            <td class="text-right"><code class="language-php"><a target="_blank" href="http://php.net/stdClass"><abbr title="stdClass">stdClass</abbr></a></code></td>
            <td>
                <code class="language-php"><a href="#method_toStdClass">toStdClass</a>()</code>
            </td>
            <td>
                                    No description
                            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                                    </code>
            </td>
            <td class="text-right"><code class="language-php">mixed</code></td>
            <td>
                <code class="language-php"><a href="#method_jsonSerialize">jsonSerialize</a>()</code>
            </td>
            <td>
                                    No description
                            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                                    </code>
            </td>
            <td class="text-right"><code class="language-php">bool</code></td>
            <td>
                <code class="language-php"><a href="#method_isVPPAAccepted">isVPPAAccepted</a>()</code>
            </td>
            <td>
                                    Gets the represented VPPA status. This does not perform validation as to
when VPPA was accepted. The caller must use this in conjunction with
getVPPALastUpdated() to determine if the acceptance is still valid.            </td>
            <td></td>
        </tr>
            <tr>
            <td>
                <code class="language-php">
                                                            public                                    </code>
            </td>
            <td class="text-right"><code class="language-php"><abbr title="LibPBSAuth\DateTime">DateTime</abbr>|null</code></td>
            <td>
                <code class="language-php"><a href="#method_getVPPALastUpdated">getVPPALastUpdated</a>()</code>
            </td>
            <td>
                                    Gets the last time that VPPA was accepted by the user. Returns a \DateTime
value if an acceptance date was available. If this represents a
non-accepted VPPA agreement, then null if returned.            </td>
            <td></td>
        </tr>
        </table>


        <h2>Details</h2>

            <div id="method-details">
                        <div>
        <div class="float-right">
                            at line <a href="#source.55">55</a>
                    </div>
        <div>
            <h3 id="method_fromJSON"><code class="language-php">fromJSON()</code></h3>
            <code class="language-php">public static <a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a>&nbsp;fromJSON(string $record)</code>
        </div>
    </div>

    <div class="details">
                            <h4>Parameters</h4>

                <table class="table">
                    <tr>
                <td><code class="language-php">string</code></td>
                <td><code class="language-php">$record</code></td>
                <td></td>
            </tr>
            </table>

        
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php"><a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a></code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.68">68</a>
                    </div>
        <div>
            <h3 id="method_fromArray"><code class="language-php">fromArray()</code></h3>
            <code class="language-php">public static <a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a>&nbsp;fromArray(array $record)</code>
        </div>
    </div>

    <div class="details">
                            <h4>Parameters</h4>

                <table class="table">
                    <tr>
                <td><code class="language-php">array</code></td>
                <td><code class="language-php">$record</code></td>
                <td></td>
            </tr>
            </table>

        
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php"><a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a></code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.83">83</a>
                    </div>
        <div>
            <h3 id="method_fromStdClass"><code class="language-php">fromStdClass()</code></h3>
            <code class="language-php">public static <a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a>&nbsp;fromStdClass(<a target="_blank" href="http://php.net/stdClass"><abbr title="stdClass">stdClass</abbr></a> $record)</code>
        </div>
    </div>

    <div class="details">
                            <h4>Parameters</h4>

                <table class="table">
                    <tr>
                <td><code class="language-php"><a target="_blank" href="http://php.net/stdClass"><abbr title="stdClass">stdClass</abbr></a></code></td>
                <td><code class="language-php">$record</code></td>
                <td></td>
            </tr>
            </table>

        
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php"><a href="../LibPBSAuth/Result/VPPAResult.html"><abbr title="LibPBSAuth\Result\VPPAResult">VPPAResult</abbr></a></code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.112">112</a>
                    </div>
        <div>
            <h3 id="method_toArray"><code class="language-php">toArray()</code></h3>
            <code class="language-php">public array&nbsp;toArray()</code>
        </div>
    </div>

    <div class="details">
                
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php">array</code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.122">122</a>
                    </div>
        <div>
            <h3 id="method_toStdClass"><code class="language-php">toStdClass()</code></h3>
            <code class="language-php">public <a target="_blank" href="http://php.net/stdClass"><abbr title="stdClass">stdClass</abbr></a>&nbsp;toStdClass()</code>
        </div>
    </div>

    <div class="details">
                
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php"><a target="_blank" href="http://php.net/stdClass"><abbr title="stdClass">stdClass</abbr></a></code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.129">129</a>
                    </div>
        <div>
            <h3 id="method_jsonSerialize"><code class="language-php">jsonSerialize()</code></h3>
            <code class="language-php">public mixed&nbsp;jsonSerialize()</code>
        </div>
    </div>

    <div class="details">
                
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php">mixed</code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.147">147</a>
                    </div>
        <div>
            <h3 id="method_isVPPAAccepted"><code class="language-php">isVPPAAccepted()</code></h3>
            <code class="language-php">public bool&nbsp;isVPPAAccepted()</code>
        </div>
    </div>

    <div class="details">
                    <div>
                                    <p>Gets the represented VPPA status. This does not perform validation as to
when VPPA was accepted. The caller must use this in conjunction with
getVPPALastUpdated() to determine if the acceptance is still valid.</p>                                </div>
                
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php">bool</code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

                        <div>
        <div class="float-right">
                            at line <a href="#source.162">162</a>
                    </div>
        <div>
            <h3 id="method_getVPPALastUpdated"><code class="language-php">getVPPALastUpdated()</code></h3>
            <code class="language-php">public <abbr title="LibPBSAuth\DateTime">DateTime</abbr>|null&nbsp;getVPPALastUpdated()</code>
        </div>
    </div>

    <div class="details">
                    <div>
                                    <p>Gets the last time that VPPA was accepted by the user. Returns a \DateTime
value if an acceptance date was available. If this represents a
non-accepted VPPA agreement, then null if returned.</p>                                </div>
                
                    <h4>Return Value</h4>

                <table class="table">
        <tr>
            <td><code class="language-php"><abbr title="LibPBSAuth\DateTime">DateTime</abbr>|null</code></td>
            <td></td>
        </tr>
    </table>

        
        
            </div>

            </div>

    
    <h2>Source code</h2>
    <pre class="language-php line-numbers" id="source"><code>&lt;?php

namespace LibPBSAuth;

use LibPBSAuth\Result\VPPAResult;

/**
 * Class VPPA
 *
 * Describes VPPA agreement information for the authenticated user and the
 * authenticating station. Requires only that the vppa_accepted and
 * vppa_last_updated fields are present. If vppa_last_updated contains a truthy
 * value, then it must be able to be parsed into a \DateTime.
 *
 * @package LibPBSAuth
 */
class VPPA implements \JsonSerializable {

  /**
   * @var array
   */
  const EXISTS = [
    &#039;vppa_accepted&#039;, &#039;vppa_last_updated&#039;
  ];

  /**
   * @var string
   */
  const DATEFORMAT = &#039;Y-m-d H:i:s.uP&#039;;

  /**
   * @var bool
   */
  private $_vppaAccepted;

  /**
   * @var \DateTime
   */
  private $_vppaLastUpdated;

  /**
   * VPPA constructor.
   * @param bool|null $vppaAccepted
   * @param \DateTime|null $vppaLastUpdated
   */
  private function __construct(?bool $vppaAccepted, ?\DateTime $vppaLastUpdated) {
    $this-&gt;_vppaAccepted = $vppaAccepted;
    $this-&gt;_vppaLastUpdated = $vppaLastUpdated;
  }

  /**
   * @param string $record
   * @return VPPAResult
   */
  public static function fromJSON(string $record): VPPAResult {
    try {
      $parsed = ex_json_decode($record);
      return self::fromStdClass($parsed);
    } catch (\Exception $e) {
      return VPPAResult::err($e);
    }
  }

  /**
   * @param array $record
   * @return VPPAResult
   */
  public static function fromArray(array $record): VPPAResult {

    // Records do not get terribly large, so for simplicity we encode and then
    // decode from JSON at the cost of a little performance
    try {
      return self::fromJSON(ex_json_encode($record));
    } catch (\Exception $e) {
      return VPPAResult::err($e);
    }
  }

  /**
   * @param \stdClass $record
   * @return VPPAResult
   */
  public static function fromStdClass(\stdClass $record): VPPAResult {
    foreach (self::EXISTS as $req) {
      if (!property_exists($record, $req)) {
        return VPPAResult::err(new \InvalidArgumentException(&quot;Malformed VPPA data. {$req} field must be present.&quot;));
      }
    }

    // Last updated date must parse properly as a date if it is set
    $lastUpdated = null;

    if ($record-&gt;vppa_last_updated) {
      $lastUpdated = new \DateTime($record-&gt;vppa_last_updated);

      if ($lastUpdated === false) {
        return VPPAResult::err(new \InvalidArgumentException(&quot;Malformed VPPA data. Last updated date field is not correctly formatted.&quot;));
      }
    }

    return VPPAResult::ok(
      new VPPA(
        $record-&gt;vppa_accepted,
        $lastUpdated
      )
    );
  }

  /**
   * @return array
   */
  public function toArray(): array {
    return [
      &#039;vppa_accepted&#039; =&gt; $this-&gt;_getVPPAAccepted(),
      &#039;vppa_last_updated&#039; =&gt; $this-&gt;getVPPALastUpdated() === null ? null : $this-&gt;getVPPALastUpdated()-&gt;format(self::DATEFORMAT)
    ];
  }

  /**
   * @return \stdClass
   */
  public function toStdClass(): \stdClass {
    return json_decode(json_encode($this));
  }

  /**
   * @return mixed
   */
  public function jsonSerialize() {
    return $this-&gt;toArray();
  }

  /**
   * @return bool|null
   */
  private function _getVPPAAccepted(): ?bool {
    return $this-&gt;_vppaAccepted;
  }

  /**
   * Gets the represented VPPA status. This does not perform validation as to
   * when VPPA was accepted. The caller must use this in conjunction with
   * getVPPALastUpdated() to determine if the acceptance is still valid.
   *
   * @return bool
   */
  public function isVPPAAccepted(): bool {
    if ($this-&gt;_getVPPAAccepted()) {
      return true;
    }

    return false;
  }

  /**
   * Gets the last time that VPPA was accepted by the user. Returns a \DateTime
   * value if an acceptance date was available. If this represents a
   * non-accepted VPPA agreement, then null if returned.
   *
   * @return \DateTime|null
   */
  public function getVPPALastUpdated(): ?\DateTime {
    return $this-&gt;_vppaLastUpdated;
  }
}</code></pre>
    </div>
    <div class="row">
        <div id="footer">
    Generated by <a href="http://sami.sensiolabs.org/">Sami, the API Documentation Generator</a> using <a href="https://github.com/nochso/sami-theme">nochso/sami-theme</a>.
  </div>

    </div>
  </div>
    </body>

</html>
